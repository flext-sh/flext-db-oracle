#!/bin/bash
# Pre-commit hook for documentation validation
# Ensures documentation quality before commits

echo "üîç Running documentation validation..."

# Check if we're in the right directory
if [ ! -f "scripts/docs_maintenance.py" ]; then
    echo "‚ùå Documentation maintenance script not found"
    exit 1
fi

# Run validation checks
echo "Running validation checks..."
if PYTHONPATH=src poetry run python scripts/docs_maintenance.py --validate > /dev/null 2>&1; then
    echo "‚úÖ Documentation validation passed"
else
    echo "‚ùå Documentation validation failed"
    echo ""
    echo "Please fix the documentation issues before committing:"
    echo "  python scripts/docs_maintenance.py --validate"
    echo "  python scripts/docs_maintenance.py --audit"
    echo ""
    exit 1
fi

# Check for basic documentation completeness
echo "Checking documentation completeness..."

# Ensure README exists and has basic content
if [ ! -f "README.md" ]; then
    echo "‚ùå README.md not found"
    exit 1
fi

# Check minimum word count for README
word_count=$(wc -w < README.md)
if [ "$word_count" -lt 100 ]; then
    echo "‚ùå README.md too short ($word_count words, minimum 100)"
    exit 1
fi

# Check for status indicators in docs
status_indicators=$(grep -r "‚úÖ\|‚ùå\|‚ö†Ô∏è" docs/ 2>/dev/null | wc -l)
if [ "$status_indicators" -lt 10 ]; then
    echo "‚ö†Ô∏è  Low number of status indicators in docs ($status_indicators)"
    echo "Consider adding more completion status indicators"
fi

echo "‚úÖ Pre-commit documentation checks passed"
exit 0